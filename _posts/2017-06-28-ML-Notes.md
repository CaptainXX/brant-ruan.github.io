---
title: Coursera | Machine Learning Notes
category: CS
---

## Coursera | Machine Learning Notes

### Preface

**All the resources here belong to Andrew Ng and relative staffs.**

**I download them from [Coursera](https://www.coursera.org/).**

**Sincerely, thanks for your teaching and your sharing of knowledge and technique.**

**Thank you, Andrew Ng.**

### Slides

- [Lecture1.pdf]({{ site.url }}/resources/pdf/Lecture1.pdf)
- [Lecture2.pdf]({{ site.url }}/resources/pdf/Lecture2.pdf)
- [Lecture3.pdf]({{ site.url }}/resources/pdf/Lecture3.pdf)
- [Lecture4.pdf]({{ site.url }}/resources/pdf/Lecture4.pdf)
- [Lecture5.pdf]({{ site.url }}/resources/pdf/Lecture5.pdf)
- [Lecture6.pdf]({{ site.url }}/resources/pdf/Lecture6.pdf)
- [Lecture7.pdf]({{ site.url }}/resources/pdf/Lecture7.pdf)
- [Lecture8.pdf]({{ site.url }}/resources/pdf/Lecture8.pdf)
- [Lecture9.pdf]({{ site.url }}/resources/pdf/Lecture9.pdf)

### Videos

**Week 1**

- [Welcome to Machine Learning]({{ site.url }}/resources/videos/ml-week1-1-welcome-to-machine-learning.mp4)

**Week 2**

**Week 3**

**Week 4**

**Week 5**

**Week 6**

**Week 7**

**Week 8**

**Week 9**

**Week 10**

**Week 11**

### Programming Tasks

- [machine-learning-ex1.zip]({{ site.url }}/resources/code/machine-learning-ex1.zip)
- [machine-learning-ex2.zip]({{ site.url }}/resources/code/machine-learning-ex2.zip)
- [machine-learning-ex3.zip]({{ site.url }}/resources/code/machine-learning-ex3.zip)
- [machine-learning-ex4.zip]({{ site.url }}/resources/code/machine-learning-ex4.zip)

### My Notes

#### Week 1

#### Week 2

#### Week 3

#### Week 4

#### Week 5

##### BPNN Implement Notes

When implementing BPNN, you should be clear about the exact definition of `z` and `a`, that is:

{% highlight matlab %}
delta2 = zeros(hidden_layer_size, 1);
delta3 = zeros(num_labels, 1);
Delta2 = zeros(hidden_layer_size, input_layer_size + 1);
Delta3 = zeros(num_labels, hidden_layer_size + 1);

for t = 1:m,
% Note that we have put bias unit in X above
	a1 = transpose(X(t, :));
	% Feedforward
	z2 = Theta1 * a1;
	a2 = [1; sigmoid(z2)];
	z3 = Theta2 * a2;
	a3 = sigmoid(z3);
% backpropagation
	temp_y = zeros(num_labels, 1);
	temp_y(y(t)) = 1;
	delta3 = a3 - temp_y;
	delta2 = (transpose(Theta2) * delta3)(2:end) .* sigmoidGradient(z2);
	Delta3 = Delta3 + delta3 * transpose(a2);
	Delta2 = Delta2 + delta2 * transpose(a1);
end

Theta1_grad = Delta2 ./ m;
Theta2_grad = Delta3 ./ m;
{% endhighlight %}

Be clear that there exists only bias for `a` and no bias for `z`. And layer `l` doesn't contribute to the `bias` in layer `i+1`. So note that

```
z2 = Theta1 * a1;
z2 = [1; z2];
a2 = sigmoid(z2);
```

is **WRONG**. You should calculate as

```
z2 = Theta1 * a1;
a2 = [1; sigmoid(z2)];
```

Finally, pay attention to the size of `delta` and `Delta`.

##### BPNN (Vectorization)

See

> https://www.coursera.org/learn/machine-learning/programming/AiHgN/neural-network-learning/discussions/threads/QFnrpQckEeWv5yIAC00Eog  
> https://www.coursera.org/learn/machine-learning/discussions/all/threads/a8Kce_WxEeS16yIACyoj1Q

{% highlight matlab %}
X = [ones(m, 1) X];
A1 = transpose(X);
Z2 = Theta1 * A1;
A2 = sigmoid(Z2);
A2 = [ones(1, size(A2)(2)); A2];
Z3 = Theta2 * A2;
A3 = transpose(sigmoid(Z3)); % A3 is 5000 * 10
vtemp_y = eye(num_labels)(y, :); % trick!
vdelta3 = A3 - vtemp_y;
vdelta2 = (vdelta3 * Theta2)(:, 2:end) .* sigmoidGradient(transpose(Z2));
vDelta3 = transpose(vdelta3) * transpose(A2);
vDelta2 = transpose(vdelta2) * transpose(A1);

J = sum(sum(-vtemp_y .* log(A3) - (1 - vtemp_y) .* log(1 - A3)));
J = J / m;
J = J + (lambda / (2 * m)) * (sum(sum(Theta1(:, 2:end) .^ 2)) ...
	+ sum(sum(Theta2(:, 2:end) .^ 2)));
{% endhighlight %}

There are some tricks.

Expand `y` to `m * K`:

```
vtemp_y = eye(num_labels)(y, :);
```

Use `trace` or `sum(sum())` to calculate the sum of matrix:

```
J = sum(sum(-vtemp_y .* log(A3) - (1 - vtemp_y) .* log(1 - A3)));
```

The vectorization method is much faster than `for` iteration!

Thank you, mentor Tom!

#### Week 6

#### Week 7

#### Week 8

#### Week 9

#### Week 10

#### Week 11

### Summary



### Reference

- [Coursera: Machine Learning](https://www.coursera.org/learn/machine-learning/)